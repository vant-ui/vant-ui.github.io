import{u as I,V as k,b as F}from"./index-975f7530.js";import{O as N,m as $,c as q,q as U,P as M,a as z}from"./use-translate-ad5eefa4.js";import{u as A}from"./use-expose-c87283be.js";import{L as H}from"./index-5b517ddf.js";import{A as y,y as T,u as w,a0 as O,M as j,e as a,q as D,o as g,c as x,w as u,C as n,a as b,F as L,b as R}from"./vue-libs-6a67f9c6.js";import{c as G,m as J,t as K,w as Q}from"./with-install-0d9206aa.js";import{V}from"./index-c6c98967.js";import{V as W}from"./index-21ea2f73.js";import"./use-id-5464e261.js";import"./use-route-ea8124d0.js";import"./index-4437616e.js";import"./index-a14bebed.js";import"./use-touch-06ff9235.js";import"./constant-ee6e27d7.js";import"./on-popup-reopen-2b57f4ff.js";import"./use-refs-4e2d69f7.js";import"./index-a81fbffb.js";import"./interceptor-e18d38f8.js";import"./index-1c02023b.js";const[X,h,Y]=q("list"),Z={error:Boolean,offset:G(300),loading:Boolean,disabled:Boolean,finished:Boolean,errorText:String,direction:J("down"),loadingText:String,finishedText:String,immediateCheck:K},ee=y({name:X,props:Z,emits:["load","update:error","update:loading"],setup(r,{emit:l,slots:t}){const s=T(r.loading),c=T(),f=T(),e=I(),i=N(c),d=()=>{D(()=>{if(s.value||r.finished||r.disabled||r.error||(e==null?void 0:e.value)===!1)return;const{direction:o}=r,v=+r.offset,m=U(i);if(!m.height||M(c))return;let p=!1;const C=U(f);o==="up"?p=m.top-C.top<=v:p=C.bottom-m.bottom<=v,p&&(s.value=!0,l("update:loading",!0),l("load"))})},B=()=>{if(r.finished){const o=t.finished?t.finished():r.finishedText;if(o)return a("div",{class:h("finished-text")},[o])}},E=()=>{l("update:error",!1),d()},S=()=>{if(r.error){const o=t.error?t.error():r.errorText;if(o)return a("div",{role:"button",class:h("error-text"),tabindex:0,onClick:E},[o])}},_=()=>{if(s.value&&!r.finished&&!r.disabled)return a("div",{class:h("loading")},[t.loading?t.loading():a(H,{class:h("loading-icon")},{default:()=>[r.loadingText||Y("loading")]})])};return w(()=>[r.loading,r.finished,r.error],d),e&&w(e,o=>{o&&d()}),O(()=>{s.value=r.loading}),j(()=>{r.immediateCheck&&d()}),A({check:d}),$("scroll",d,{target:i,passive:!0}),()=>{var m;const o=(m=t.default)==null?void 0:m.call(t),v=a("div",{ref:f,class:h("placeholder")},null);return a("div",{ref:c,role:"feed",class:h(),"aria-busy":s.value},[r.direction==="down"?o:v,_(),B(),S(),r.direction==="up"?o:v])}}}),te=Q(ee),P=te,be=y({__name:"index",setup(r){const l=z({"zh-CN":{errorInfo:"错误提示",errorText:"请求失败，点击重新加载",pullRefresh:"下拉刷新",finishedText:"没有更多了"},"en-US":{errorInfo:"Error Info",errorText:"Request failed. Click to reload",pullRefresh:"PullRefresh",finishedText:"Finished"}}),t=T([{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1}]),s=f=>{const e=t.value[f];e.loading=!0,setTimeout(()=>{e.refreshing&&(e.items=[],e.refreshing=!1);for(let i=0;i<10;i++){const d=e.items.length+1;e.items.push(d<10?"0"+d:String(d))}e.loading=!1,e.refreshing=!1,f===1&&e.items.length===10&&!e.error?e.error=!0:e.error=!1,e.items.length>=40&&(e.finished=!0)},1e3)},c=f=>{t.value[f].finished=!1,s(f)};return(f,e)=>(g(),x(n(F),null,{default:u(()=>[a(n(k),{title:n(l)("basicUsage")},{default:u(()=>[a(n(P),{loading:t.value[0].loading,"onUpdate:loading":e[0]||(e[0]=i=>t.value[0].loading=i),finished:t.value[0].finished,"finished-text":n(l)("finishedText"),onLoad:e[1]||(e[1]=i=>s(0))},{default:u(()=>[(g(!0),b(L,null,R(t.value[0].items,i=>(g(),x(n(V),{key:i,title:i},null,8,["title"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["title"]),a(n(k),{title:n(l)("errorInfo")},{default:u(()=>[a(n(P),{loading:t.value[1].loading,"onUpdate:loading":e[2]||(e[2]=i=>t.value[1].loading=i),error:t.value[1].error,"onUpdate:error":e[3]||(e[3]=i=>t.value[1].error=i),finished:t.value[1].finished,"error-text":n(l)("errorText"),onLoad:e[4]||(e[4]=i=>s(1))},{default:u(()=>[(g(!0),b(L,null,R(t.value[1].items,i=>(g(),x(n(V),{key:i,title:i},null,8,["title"]))),128))]),_:1},8,["loading","error","finished","error-text"])]),_:1},8,["title"]),a(n(k),{title:n(l)("pullRefresh")},{default:u(()=>[a(n(W),{modelValue:t.value[2].refreshing,"onUpdate:modelValue":e[7]||(e[7]=i=>t.value[2].refreshing=i),onRefresh:e[8]||(e[8]=i=>c(2))},{default:u(()=>[a(n(P),{loading:t.value[2].loading,"onUpdate:loading":e[5]||(e[5]=i=>t.value[2].loading=i),finished:t.value[2].finished,"finished-text":n(l)("finishedText"),onLoad:e[6]||(e[6]=i=>s(2))},{default:u(()=>[(g(!0),b(L,null,R(t.value[2].items,i=>(g(),x(n(V),{key:i,title:i},null,8,["title"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["title"])]),_:1}))}});export{be as default};
