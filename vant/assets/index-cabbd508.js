import{u as F,V as k,b as N}from"./index-7e56372d.js";import{O as $,m as q,c as M,q as w,P as O,a as j}from"./use-translate-71d4880c.js";import{u as z}from"./use-expose-80cfd2b2.js";import{L as A}from"./index-2b75ebd8.js";import{A as B,y as p,D,u as y,a0 as H,M as G,e as l,q as J,o as u,c as T,w as f,C as n,a as L,F as R,b as V}from"./vue-libs-19c20d28.js";import{c as K,m as Q,t as W,w as X}from"./with-install-560d59bf.js";import{V as P}from"./index-122de2bc.js";import{V as Y}from"./index-93f20988.js";import"./use-id-09c3f4cb.js";import"./use-route-751feeeb.js";import"./index-8bc2514f.js";import"./index-a26cde52.js";import"./use-touch-4e22f945.js";import"./constant-ee6e27d7.js";import"./on-popup-reopen-6f4c2d78.js";import"./use-refs-c698ebdb.js";import"./index-7f2a8246.js";import"./interceptor-5424332a.js";import"./index-1ef61aa2.js";const[Z,h,ee]=M("list"),te={error:Boolean,offset:K(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:Q("down"),loadingText:String,finishedText:String,immediateCheck:W},re=B({name:Z,props:te,emits:["load","update:error","update:loading"],setup(i,{emit:a,slots:t}){const s=p(i.loading),v=p(),d=p(),e=F(),r=$(v),g=D(()=>i.scroller||r.value),m=()=>{J(()=>{if(s.value||i.finished||i.disabled||i.error||(e==null?void 0:e.value)===!1)return;const{direction:o}=i,x=+i.offset,c=w(g);if(!c.height||O(v))return;let b=!1;const U=w(d);o==="up"?b=c.top-U.top<=x:b=U.bottom-c.bottom<=x,b&&(s.value=!0,a("update:loading",!0),a("load"))})},E=()=>{if(i.finished){const o=t.finished?t.finished():i.finishedText;if(o)return l("div",{class:h("finished-text")},[o])}},S=()=>{a("update:error",!1),m()},_=()=>{if(i.error){const o=t.error?t.error():i.errorText;if(o)return l("div",{role:"button",class:h("error-text"),tabindex:0,onClick:S},[o])}},I=()=>{if(s.value&&!i.finished&&!i.disabled)return l("div",{class:h("loading")},[t.loading?t.loading():l(A,{class:h("loading-icon")},{default:()=>[i.loadingText||ee("loading")]})])};return y(()=>[i.loading,i.finished,i.error],m),e&&y(e,o=>{o&&m()}),H(()=>{s.value=i.loading}),G(()=>{i.immediateCheck&&m()}),z({check:m}),q("scroll",m,{target:g,passive:!0}),()=>{var c;const o=(c=t.default)==null?void 0:c.call(t),x=l("div",{ref:d,class:h("placeholder")},null);return l("div",{ref:v,role:"feed",class:h(),"aria-busy":s.value},[i.direction==="down"?o:x,I(),E(),_(),i.direction==="up"?o:x])}}}),ie=X(re),C=ie,Re=B({__name:"index",setup(i){const a=j({"zh-CN":{errorInfo:"错误提示",errorText:"请求失败，点击重新加载",pullRefresh:"下拉刷新",finishedText:"没有更多了"},"en-US":{errorInfo:"Error Info",errorText:"Request failed. Click to reload",pullRefresh:"PullRefresh",finishedText:"Finished"}}),t=p([{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1}]),s=d=>{const e=t.value[d];e.loading=!0,setTimeout(()=>{e.refreshing&&(e.items=[],e.refreshing=!1);for(let r=0;r<10;r++){const g=e.items.length+1;e.items.push(g<10?"0"+g:String(g))}e.loading=!1,e.refreshing=!1,d===1&&e.items.length===10&&!e.error?e.error=!0:e.error=!1,e.items.length>=40&&(e.finished=!0)},1e3)},v=d=>{t.value[d].finished=!1,s(d)};return(d,e)=>(u(),T(n(N),null,{default:f(()=>[l(n(k),{title:n(a)("basicUsage")},{default:f(()=>[l(n(C),{loading:t.value[0].loading,"onUpdate:loading":e[0]||(e[0]=r=>t.value[0].loading=r),finished:t.value[0].finished,"finished-text":n(a)("finishedText"),onLoad:e[1]||(e[1]=r=>s(0))},{default:f(()=>[(u(!0),L(R,null,V(t.value[0].items,r=>(u(),T(n(P),{key:r,title:r},null,8,["title"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["title"]),l(n(k),{title:n(a)("errorInfo")},{default:f(()=>[l(n(C),{loading:t.value[1].loading,"onUpdate:loading":e[2]||(e[2]=r=>t.value[1].loading=r),error:t.value[1].error,"onUpdate:error":e[3]||(e[3]=r=>t.value[1].error=r),finished:t.value[1].finished,"error-text":n(a)("errorText"),onLoad:e[4]||(e[4]=r=>s(1))},{default:f(()=>[(u(!0),L(R,null,V(t.value[1].items,r=>(u(),T(n(P),{key:r,title:r},null,8,["title"]))),128))]),_:1},8,["loading","error","finished","error-text"])]),_:1},8,["title"]),l(n(k),{title:n(a)("pullRefresh")},{default:f(()=>[l(n(Y),{modelValue:t.value[2].refreshing,"onUpdate:modelValue":e[7]||(e[7]=r=>t.value[2].refreshing=r),onRefresh:e[8]||(e[8]=r=>v(2))},{default:f(()=>[l(n(C),{loading:t.value[2].loading,"onUpdate:loading":e[5]||(e[5]=r=>t.value[2].loading=r),finished:t.value[2].finished,"finished-text":n(a)("finishedText"),onLoad:e[6]||(e[6]=r=>s(2))},{default:f(()=>[(u(!0),L(R,null,V(t.value[2].items,r=>(u(),T(n(P),{key:r,title:r},null,8,["title"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["title"])]),_:1}))}});export{Re as default};
