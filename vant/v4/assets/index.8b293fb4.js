import{c as R,e as f,p as I,h as K,t as k,z as U,d as _}from"./use-translate.5fa8a2a1.js";import{n as z,u as L,m as M,t as P,w as W}from"./with-install.ff23f643.js";import{A as p,u as V,H as X,e as n,B as D,X as j}from"./vue-libs.ed3d9812.js";import{e as q,c as G}from"./constant.e12a51b9.js";import{c as J}from"./interceptor.f92ff708.js";import{p as Q,a as Y,P as Z}from"./index.84111d02.js";import{B as T}from"./index.284de8db.js";import{b as v,a as $}from"./index.5e03b6de.js";import{m as ee,u as te}from"./mount-component.6bbd68ed.js";const[ne,l,d]=R("dialog"),oe=f({},Q,{title:String,theme:String,width:z,message:[String,Function],callback:Function,allowHtml:Boolean,className:L,transition:M("van-dialog-bounce"),messageAlign:String,closeOnPopstate:P,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:P,closeOnClickOverlay:Boolean}),ae=[...Y,"transition","closeOnPopstate"],S=p({name:ne,props:oe,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:r,slots:o}){const u=V(),i=X({confirm:!1,cancel:!1}),C=t=>r("update:show",t),b=t=>{var a;C(!1),(a=e.callback)==null||a.call(e,t)},y=t=>()=>{!e.show||(r(t),e.beforeClose?(i[t]=!0,J(e.beforeClose,{args:[t],done(){b(t),i[t]=!1},canceled(){i[t]=!1}})):b(t))},B=y("cancel"),g=y("confirm"),x=j(t=>{var s,c;if(t.target!==((c=(s=u.value)==null?void 0:s.popupRef)==null?void 0:c.value))return;({Enter:e.showConfirmButton?g:k,Escape:e.showCancelButton?B:k})[t.key](),r("keydown",t)},["enter","esc"]),O=()=>{const t=o.title?o.title():e.title;if(t)return n("div",{class:l("header",{isolated:!e.message&&!o.default})},[t])},A=t=>{const{message:a,allowHtml:s,messageAlign:c}=e,m=l("message",{"has-title":t,[c]:c}),w=U(a)?a():a;return s&&typeof w=="string"?n("div",{class:m,innerHTML:w},null):n("div",{class:m},[w])},E=()=>{if(o.default)return n("div",{class:l("content")},[o.default()]);const{title:t,message:a,allowHtml:s}=e;if(a){const c=!!(t||o.title);return n("div",{key:s?1:0,class:l("content",{isolated:!c})},[A(c)])}},H=()=>n("div",{class:[G,l("footer")]},[e.showCancelButton&&n(T,{size:"large",text:e.cancelButtonText||d("cancel"),class:l("cancel"),style:{color:e.cancelButtonColor},loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&n(T,{size:"large",text:e.confirmButtonText||d("confirm"),class:[l("confirm"),{[q]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),N=()=>n($,{class:l("footer")},{default:()=>[e.showCancelButton&&n(v,{type:"warning",text:e.cancelButtonText||d("cancel"),class:l("cancel"),color:e.cancelButtonColor,loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&n(v,{type:"danger",text:e.confirmButtonText||d("confirm"),class:l("confirm"),color:e.confirmButtonColor,loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),F=()=>o.footer?o.footer():e.theme==="round-button"?N():H();return()=>{const{width:t,title:a,theme:s,message:c,className:m}=e;return n(Z,D({ref:u,role:"dialog",class:[l([s]),m],style:{width:K(t)},tabindex:0,"aria-labelledby":a||c,onKeydown:x,"onUpdate:show":C},I(e,ae)),{default:()=>[O(),E(),F()]})}}});let h;const le={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let ce=f({},le);function se(){({instance:h}=ee({setup(){const{state:r,toggle:o}=te();return()=>n(S,D(r,{"onUpdate:show":o}),null)}}))}function re(e){return _?new Promise((r,o)=>{h||se(),h.open(f({},ce,e,{callback:u=>{(u==="confirm"?r:o)(u)}}))}):Promise.resolve()}const Ce=e=>re(f({showCancelButton:!0},e)),be=W(S);export{be as D,Ce as a,re as s};
